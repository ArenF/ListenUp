# í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„ ë³´ê³ ì„œ

## ğŸ“‹ ëª©ì°¨
1. [ê°œìš”](#ê°œìš”)
2. [êµ¬í˜„ ëª©í‘œ](#êµ¬í˜„-ëª©í‘œ)
3. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
4. [Backend êµ¬í˜„](#backend-êµ¬í˜„)
5. [Frontend êµ¬í˜„](#frontend-êµ¬í˜„)
6. [API ëª…ì„¸](#api-ëª…ì„¸)
7. [ë°ì´í„° ëª¨ë¸](#ë°ì´í„°-ëª¨ë¸)
8. [ì£¼ìš” ê¸°ëŠ¥](#ì£¼ìš”-ê¸°ëŠ¥)
9. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)
10. [í…ŒìŠ¤íŠ¸ ê²°ê³¼](#í…ŒìŠ¤íŠ¸-ê²°ê³¼)
11. [í–¥í›„ ê°œì„  ì‚¬í•­](#í–¥í›„-ê°œì„ -ì‚¬í•­)

---

## ê°œìš”

### í”„ë¡œì íŠ¸ ì •ë³´
- **êµ¬í˜„ ì¼ì**: 2025-11-09
- **êµ¬í˜„ì**: ListenUp! Team
- **ëª©ì **: ì‚¬ìš©ì ì •ì˜ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„± ë° ê´€ë¦¬ ê¸°ëŠ¥ êµ¬í˜„

### êµ¬í˜„ ë°°ê²½
ê¸°ì¡´ ì‹œìŠ¤í…œì€ ê³ ì •ëœ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ë§Œ ì‚¬ìš© ê°€ëŠ¥í–ˆìœ¼ë©°, ì‚¬ìš©ìê°€ ì›í•˜ëŠ” íŠ¸ë™ìœ¼ë¡œ ê²Œì„ì„ ì§„í–‰í•  ìˆ˜ ì—†ëŠ” ì œì•½ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì»¤ìŠ¤í…€ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„± ë° ê´€ë¦¬ ê¸°ëŠ¥ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

---

## êµ¬í˜„ ëª©í‘œ

### í•µì‹¬ ìš”êµ¬ì‚¬í•­
1. âœ… í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ CRUD (ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ) ê¸°ëŠ¥
2. âœ… YouTube íŠ¸ë™ ê²€ìƒ‰ ë° ì¶”ê°€ ê¸°ëŠ¥
3. âœ… í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì˜êµ¬ ì €ì¥ (JSON íŒŒì¼)
4. âœ… ë°© ìƒì„± ì‹œ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì„ íƒ ê¸°ëŠ¥
5. âœ… ì§ê´€ì ì¸ UI/UX

### ê¸°ìˆ ì  ëª©í‘œ
- RESTful API ì„¤ê³„
- íŒŒì¼ ê¸°ë°˜ ë°ì´í„° ì˜ì†ì„±
- ë°˜ì‘í˜• UI êµ¬í˜„
- ì—ëŸ¬ í•¸ë“¤ë§ ë° ì‚¬ìš©ì í”¼ë“œë°±

---

## ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì „ì²´ êµ¬ì¡°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Client (Vite)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  PlaylistManager.svelte                  â”‚   â”‚
â”‚  â”‚  - í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ëª©ë¡ ì¡°íšŒ                â”‚   â”‚
â”‚  â”‚  - ìƒì„±/ìˆ˜ì •/ì‚­ì œ UI                    â”‚   â”‚
â”‚  â”‚  - íŠ¸ë™ ì¶”ê°€/ì œê±° UI                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  App.svelte                              â”‚   â”‚
â”‚  â”‚  - í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì„ íƒ ë“œë¡­ë‹¤ìš´            â”‚   â”‚
â”‚  â”‚  - í˜ì´ì§€ ë¼ìš°íŒ…                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“ HTTP/REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Server (Express)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  REST API Endpoints                      â”‚   â”‚
â”‚  â”‚  - GET    /api/playlists                 â”‚   â”‚
â”‚  â”‚  - POST   /api/playlists                 â”‚   â”‚
â”‚  â”‚  - PUT    /api/playlists/:id             â”‚   â”‚
â”‚  â”‚  - DELETE /api/playlists/:id             â”‚   â”‚
â”‚  â”‚  - POST   /api/playlists/:id/tracks      â”‚   â”‚
â”‚  â”‚  - DELETE /api/playlists/:id/tracks/:id  â”‚   â”‚
â”‚  â”‚  - GET    /api/youtube/track/:id         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  PlaylistService                         â”‚   â”‚
â”‚  â”‚  - CRUD ë¡œì§                             â”‚   â”‚
â”‚  â”‚  - JSON íŒŒì¼ I/O                         â”‚   â”‚
â”‚  â”‚  - ë°ì´í„° ê²€ì¦                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         File System (playlists.json)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Backend êµ¬í˜„

### 1. PlaylistService (packages/server/src/services/playlist.ts)

#### ì£¼ìš” ê¸°ëŠ¥
```typescript
export class PlaylistService {
  private playlists: Map<string, Playlist>;
  private playlistsFilePath: string;

  // ì´ˆê¸°í™” ë° ë°ì´í„° ë¡œë“œ
  async initialize(): Promise<void>

  // CRUD ì‘ì—…
  getAllPlaylists(): Playlist[]
  getPlaylist(id: string): Playlist | undefined
  async createPlaylist(name, description, trackIds): Promise<Result>
  async updatePlaylist(id, updates): Promise<Result>
  async deletePlaylist(id): Promise<Result>

  // íŠ¸ë™ ê´€ë¦¬
  async addTrack(playlistId, trackId): Promise<Result>
  async removeTrack(playlistId, trackId): Promise<Result>

  // ìœ í‹¸ë¦¬í‹°
  private async savePlaylists(): Promise<void>
  getStats(): Stats
}
```

#### í•µì‹¬ êµ¬í˜„ ì‚¬í•­

**1) íŒŒì¼ ê¸°ë°˜ ì˜ì†ì„±**
```typescript
private async savePlaylists(): Promise<void> {
  const playlistsObject: Record<string, Playlist> = {};

  for (const [key, playlist] of this.playlists.entries()) {
    playlistsObject[key] = playlist;
  }

  await fs.writeFile(
    this.playlistsFilePath,
    JSON.stringify(playlistsObject, null, 2),
    "utf-8"
  );
}
```

**2) íŠ¸ëœì­ì…˜ ì•ˆì „ì„±**
```typescript
async createPlaylist(name, description, trackIds) {
  const id = `custom-${nanoid(8)}`;
  const playlist = { id, name, description, trackIds, roundCount };

  this.playlists.set(id, playlist);

  try {
    await this.savePlaylists();
    return { success: true, playlist };
  } catch (error) {
    // ë¡¤ë°±
    this.playlists.delete(id);
    return { success: false, error: "ì €ì¥ ì‹¤íŒ¨" };
  }
}
```

**3) ë°ì´í„° ê²€ì¦**
- ì´ë¦„ ì¤‘ë³µ ì²´í¬
- íŠ¸ë™ ì¤‘ë³µ ì²´í¬
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ í™•ì¸

### 2. REST API ì—”ë“œí¬ì¸íŠ¸ (packages/server/src/index.ts)

#### êµ¬í˜„ëœ ì—”ë“œí¬ì¸íŠ¸

**í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ**
```typescript
app.get("/api/playlists", (_req, res) => {
  const allPlaylists = playlistService.getAllPlaylists();
  res.json(allPlaylists);
});

app.get("/api/playlists/:id", (req, res) => {
  const playlist = playlistService.getPlaylist(req.params.id);
  if (!playlist) return res.status(404).json({ error: "Not found" });
  return res.json(playlist);
});
```

**í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„±**
```typescript
app.post("/api/playlists", async (req, res) => {
  const { name, description, trackIds } = req.body;

  if (!name || typeof name !== "string") {
    return res.status(400).json({ error: "Name is required" });
  }

  const result = await playlistService.createPlaylist(
    name,
    description || "",
    trackIds || []
  );

  if (!result.success) {
    return res.status(400).json({ error: result.error });
  }

  return res.status(201).json(result.playlist);
});
```

**íŠ¸ë™ ê´€ë¦¬**
```typescript
// íŠ¸ë™ ì¶”ê°€
app.post("/api/playlists/:id/tracks", async (req, res) => {
  const { id } = req.params;
  const { trackId } = req.body;

  const result = await playlistService.addTrack(id, trackId);
  if (!result.success) {
    return res.status(400).json({ error: result.error });
  }
  return res.json(result.playlist);
});

// íŠ¸ë™ ì œê±°
app.delete("/api/playlists/:id/tracks/:trackId", async (req, res) => {
  const { id, trackId } = req.params;

  const result = await playlistService.removeTrack(id, trackId);
  if (!result.success) {
    return res.status(400).json({ error: result.error });
  }
  return res.json(result.playlist);
});
```

**YouTube íŠ¸ë™ ì¡°íšŒ**
```typescript
app.get("/api/youtube/track/:trackId", async (req, res) => {
  const track = await youtubeService.getTrack(req.params.trackId);

  if (!track) {
    return res.status(404).json({ error: "Track not found" });
  }

  return res.json(track);
});
```

### 3. ì„œë²„ ì´ˆê¸°í™” í†µí•©

```typescript
async function startServer() {
  validateEnvYouTube();

  // í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì„œë¹„ìŠ¤ ì´ˆê¸°í™”
  await playlistService.initialize();

  httpServer.listen(config.server.port, () => {
    console.log(`Server running on http://localhost:${config.server.port}`);
    console.log(`Socket.IO Ready`);
  });
}

startServer().catch((error) => {
  console.error("Failed to start server:", error);
  process.exit(1);
});
```

---

## Frontend êµ¬í˜„

### 1. PlaylistManager ì»´í¬ë„ŒíŠ¸

#### íŒŒì¼ êµ¬ì¡°
- **ìœ„ì¹˜**: `packages/client/src/lib/components/PlaylistManager.svelte`
- **ë¼ì¸ ìˆ˜**: ~710 lines (including styles)

#### ì£¼ìš” ìƒíƒœ ê´€ë¦¬
```typescript
// ë°ì´í„° ìƒíƒœ
let playlists = $state<Playlist[]>([]);
let selectedPlaylist = $state<Playlist | null>(null);
let tracks = $state<Track[]>([]);

// UI ìƒíƒœ
let loading = $state(false);
let error = $state("");
let showPlaylistForm = $state(false);
let showTrackForm = $state(false);

// í¼ ìƒíƒœ
let formMode = $state<"create" | "edit">("create");
let formName = $state("");
let formDescription = $state("");
let trackId = $state("");
let trackInfo = $state<Track | null>(null);
```

#### í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„

**1) í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ëª©ë¡ ë¡œë“œ**
```typescript
async function loadPlaylists() {
  try {
    loading = true;
    error = "";
    const response = await fetch("/api/playlists");
    if (!response.ok) throw new Error("Failed to fetch playlists");
    playlists = await response.json();
  } catch (err: any) {
    error = err.message;
  } finally {
    loading = false;
  }
}
```

**2) í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„±/ìˆ˜ì •**
```typescript
async function savePlaylist() {
  if (!formName.trim()) {
    alert("í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”");
    return;
  }

  loading = true;

  if (formMode === "create") {
    const response = await fetch("/api/playlists", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        name: formName.trim(),
        description: formDescription.trim(),
        trackIds: [],
      }),
    });

    if (!response.ok) throw new Error("ìƒì„± ì‹¤íŒ¨");

    const newPlaylist = await response.json();
    playlists = [...playlists, newPlaylist];
    selectedPlaylist = newPlaylist;
  } else {
    // ìˆ˜ì • ë¡œì§
  }

  showPlaylistForm = false;
}
```

**3) YouTube íŠ¸ë™ ê²€ìƒ‰ ë° ì¶”ê°€**
```typescript
async function searchTrack() {
  if (!trackId.trim()) return;

  loadingTrack = true;
  const response = await fetch(`/api/youtube/track/${trackId.trim()}`);

  if (!response.ok) throw new Error("íŠ¸ë™ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");

  trackInfo = await response.json();
  loadingTrack = false;
}

async function addTrack() {
  if (!selectedPlaylist || !trackInfo) return;

  const response = await fetch(
    `/api/playlists/${selectedPlaylist.id}/tracks`,
    {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ trackId: trackInfo.id }),
    }
  );

  const updatedPlaylist = await response.json();
  playlists = playlists.map((p) =>
    p.id === updatedPlaylist.id ? updatedPlaylist : p
  );
  tracks = [...tracks, trackInfo];
}
```

#### UI êµ¬ì„±

**ë ˆì´ì•„ì›ƒ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ğŸµ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì‚¬ì´ë“œë°”     â”‚           ë©”ì¸ ì˜ì—­               â”‚
â”‚             â”‚                                   â”‚
â”‚ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ ëª©ë¡        â”‚  â”‚  ì„ íƒëœ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì •ë³´    â”‚  â”‚
â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ - ëª©ë¡ 1    â”‚                                   â”‚
â”‚ - ëª©ë¡ 2    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ - ëª©ë¡ 3    â”‚  â”‚      íŠ¸ë™ ëª©ë¡              â”‚  â”‚
â”‚             â”‚  â”‚  1. Track 1                 â”‚  â”‚
â”‚ [+ ìƒˆë¡œ]    â”‚  â”‚  2. Track 2                 â”‚  â”‚
â”‚             â”‚  â”‚  [+ íŠ¸ë™ ì¶”ê°€]              â”‚  â”‚
â”‚             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. App.svelte í†µí•©

#### í˜ì´ì§€ ë¼ìš°íŒ…
```typescript
// í˜ì´ì§€ ìƒíƒœ
let currentPage = $state<"game" | "playlist">("game");

// ë„¤ë¹„ê²Œì´ì…˜ ë°”
<nav class="navbar">
  <h1>ğŸµ ListenUp!</h1>
  <div class="nav-buttons">
    <button
      class:active={currentPage === "game"}
      onclick={() => currentPage = "game"}
    >
      ğŸ® ê²Œì„
    </button>
    <button
      class:active={currentPage === "playlist"}
      onclick={() => currentPage = "playlist"}
    >
      ğŸµ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬
    </button>
  </div>
</nav>

// ì¡°ê±´ë¶€ ë Œë”ë§
{#if currentPage === "playlist"}
  <PlaylistManager />
{:else}
  <!-- ê²Œì„ í˜ì´ì§€ -->
{/if}
```

#### í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì„ íƒ UI
```typescript
// ìƒíƒœ
let playlists = $state<any[]>([]);
let selectedPlaylistId = $state("test-playlist");

// í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë¡œë“œ
async function loadPlaylists() {
  const response = await fetch("/api/playlists");
  if (response.ok) {
    playlists = await response.json();
  }
}

// ë°© ìƒì„± í¼ì— ë“œë¡­ë‹¤ìš´ ì¶”ê°€
<select bind:value={selectedPlaylistId}>
  {#each playlists as playlist}
    <option value={playlist.id}>
      {playlist.name} ({playlist.trackIds.length} íŠ¸ë™)
    </option>
  {/each}
</select>
```

### 3. Vite í”„ë¡ì‹œ ì„¤ì •

#### vite.config.ts
```typescript
export default defineConfig({
  plugins: [svelte()],
  server: {
    port: 5173,
    proxy: {
      "/socket.io": {
        target: "http://localhost:3000",
        ws: true,
      },
      "/api": {
        target: "http://localhost:3000",
        changeOrigin: true,
      },
    },
  },
});
```

**í”„ë¡ì‹œê°€ í•„ìš”í•œ ì´ìœ **:
- CORS ë¬¸ì œ í•´ê²°
- ê°œë°œ í™˜ê²½ì—ì„œ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ë¥¼ ë¶„ë¦¬í•˜ì—¬ ì‹¤í–‰
- ìƒëŒ€ ê²½ë¡œ ì‚¬ìš©ìœ¼ë¡œ ì½”ë“œ ê°„ê²°ì„± í–¥ìƒ

---

## API ëª…ì„¸

### í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬

| Method | Endpoint | Request Body | Response | ì„¤ëª… |
|--------|----------|--------------|----------|------|
| GET | `/api/playlists` | - | `Playlist[]` | ëª¨ë“  í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ |
| GET | `/api/playlists/:id` | - | `Playlist` | íŠ¹ì • í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ |
| POST | `/api/playlists` | `{ name, description, trackIds }` | `Playlist` | í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„± |
| PUT | `/api/playlists/:id` | `{ name?, description?, trackIds? }` | `Playlist` | í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìˆ˜ì • |
| DELETE | `/api/playlists/:id` | - | `{ message }` | í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì‚­ì œ |

### íŠ¸ë™ ê´€ë¦¬

| Method | Endpoint | Request Body | Response | ì„¤ëª… |
|--------|----------|--------------|----------|------|
| POST | `/api/playlists/:id/tracks` | `{ trackId }` | `Playlist` | íŠ¸ë™ ì¶”ê°€ |
| DELETE | `/api/playlists/:id/tracks/:trackId` | - | `Playlist` | íŠ¸ë™ ì œê±° |
| GET | `/api/youtube/track/:trackId` | - | `Track` | YouTube íŠ¸ë™ ì •ë³´ ì¡°íšŒ |

### ìƒíƒœ ì½”ë“œ

| ì½”ë“œ | ì˜ë¯¸ | ìƒí™© |
|------|------|------|
| 200 | OK | ì •ìƒ ì²˜ë¦¬ |
| 201 | Created | í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„± ì„±ê³µ |
| 400 | Bad Request | ì˜ëª»ëœ ìš”ì²­ (í•„ìˆ˜ í•„ë“œ ëˆ„ë½, ì¤‘ë³µ ë“±) |
| 404 | Not Found | ë¦¬ì†ŒìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ |
| 500 | Internal Server Error | ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ |

---

## ë°ì´í„° ëª¨ë¸

### Playlist
```typescript
interface Playlist {
  id: string;              // ê³ ìœ  ID (custom-xxxxxxxx)
  name: string;            // í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì´ë¦„
  description: string;     // ì„¤ëª…
  trackIds: string[];      // YouTube ë¹„ë””ì˜¤ ID ë°°ì—´
  roundCount: number;      // ë¼ìš´ë“œ ìˆ˜ (trackIds.length)
}
```

### Track
```typescript
interface Track {
  id: string;              // YouTube ë¹„ë””ì˜¤ ID
  name: string;            // ê³¡ ì œëª©
  artist: string;          // ì•„í‹°ìŠ¤íŠ¸
  duration: number;        // ì´ ê¸¸ì´ (ì´ˆ)
  startSeconds: number;    // ì¬ìƒ ì‹œì‘ ì‹œê°„
  endSeconds: number;      // ì¬ìƒ ì¢…ë£Œ ì‹œê°„
}
```

### ì €ì¥ í˜•ì‹ (playlists.json)
```json
{
  "test-playlist": {
    "id": "test-playlist",
    "name": "í…ŒìŠ¤íŠ¸ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸",
    "description": "YouTube API í…ŒìŠ¤íŠ¸ìš©",
    "trackIds": ["dQw4w9WgXcQ", "kJQP7kiw5Fk"],
    "roundCount": 2
  },
  "custom-abc123": {
    "id": "custom-abc123",
    "name": "ë‚´ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸",
    "description": "ì»¤ìŠ¤í…€ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸",
    "trackIds": ["videoId1", "videoId2"],
    "roundCount": 2
  }
}
```

---

## ì£¼ìš” ê¸°ëŠ¥

### 1. í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ CRUD

#### ìƒì„±
- ì´ë¦„, ì„¤ëª… ì…ë ¥
- ê³ ìœ  ID ìë™ ìƒì„± (`custom-` + nanoid)
- ì´ë¦„ ì¤‘ë³µ ê²€ì‚¬
- JSON íŒŒì¼ì— ì €ì¥

#### ì¡°íšŒ
- ì „ì²´ ëª©ë¡ ì¡°íšŒ
- ê°œë³„ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ
- íŠ¸ë™ ì •ë³´ í¬í•¨ ì¡°íšŒ

#### ìˆ˜ì •
- ì´ë¦„/ì„¤ëª… ìˆ˜ì •
- íŠ¸ë™ ëª©ë¡ ìˆ˜ì •
- ì´ë¦„ ì¤‘ë³µ ê²€ì‚¬ (ìê¸° ìì‹  ì œì™¸)

#### ì‚­ì œ
- í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì‚­ì œ
- íŒŒì¼ì—ì„œ ì˜êµ¬ ì‚­ì œ

### 2. íŠ¸ë™ ê´€ë¦¬

#### YouTube íŠ¸ë™ ê²€ìƒ‰
- ë¹„ë””ì˜¤ ID ì…ë ¥
- YouTube APIë¡œ íŠ¸ë™ ì •ë³´ ì¡°íšŒ
- ë¯¸ë¦¬ë³´ê¸° ì œê³µ

#### íŠ¸ë™ ì¶”ê°€
- í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ì— íŠ¸ë™ ì¶”ê°€
- ì¤‘ë³µ ì²´í¬
- roundCount ìë™ ì¦ê°€

#### íŠ¸ë™ ì œê±°
- í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ì—ì„œ íŠ¸ë™ ì œê±°
- roundCount ìë™ ê°ì†Œ

### 3. ê²Œì„ í†µí•©

#### í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì„ íƒ
- ë°© ìƒì„± ì‹œ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì„ íƒ
- ë“œë¡­ë‹¤ìš´ UI
- íŠ¸ë™ ê°œìˆ˜ í‘œì‹œ

#### ê²Œì„ ì§„í–‰
- ì„ íƒëœ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ë¡œ ê²Œì„ ì‹œì‘
- ëœë¤ íŠ¸ë™ ì„ íƒ
- YouTube Playerë¡œ ì¬ìƒ

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: ERR_CONNECTION_REFUSED

**ì¦ìƒ**
```
Failed to load resource: net::ERR_CONNECTION_REFUSED
localhost:3000/api/playlists
```

**ì›ì¸**
- í´ë¼ì´ì–¸íŠ¸ê°€ `http://localhost:3000`ì„ ì§ì ‘ í˜¸ì¶œ
- Vite í”„ë¡ì‹œ ì„¤ì •ì— `/api` ê²½ë¡œ ì—†ìŒ
- CORS ë° í¬íŠ¸ ì¶©ëŒ

**í•´ê²°**
1. Vite í”„ë¡ì‹œ ì„¤ì • ì¶”ê°€
```typescript
proxy: {
  "/api": {
    target: "http://localhost:3000",
    changeOrigin: true,
  },
}
```

2. í´ë¼ì´ì–¸íŠ¸ ì½”ë“œ ìˆ˜ì •
```typescript
// Before
fetch("http://localhost:3000/api/playlists")

// After
fetch("/api/playlists")
```

### ë¬¸ì œ 2: TypeScript ì»´íŒŒì¼ ì˜¤ë¥˜

**ì¦ìƒ**
```
error TS7030: Not all code paths return a value
```

**ì›ì¸**
- Express í•¸ë“¤ëŸ¬ì—ì„œ ì¼ë¶€ ê²½ë¡œì— return ëˆ„ë½

**í•´ê²°**
```typescript
// Before
app.get("/api/playlists", (req, res) => {
  res.json(playlists);
});

// After
app.get("/api/playlists", (req, res) => {
  return res.json(playlists);
});
```

### ë¬¸ì œ 3: ì„œë²„ í¬ë˜ì‹œ (Transform Error)

**ì¦ìƒ**
```
ERROR: Expected identifier but found "~"
/workspaces/ListenUp/packages/server/src/index.ts:291:34
```

**ì›ì¸**
- íŒŒì¼ ìˆ˜ì • ì¤‘ íŠ¹ìˆ˜ ë¬¸ì(`~`) ì‚½ì…
- tsx watchê°€ ì—ëŸ¬ë¡œ ì¸í•´ ì„œë²„ ì¢…ë£Œ

**í•´ê²°**
1. íŠ¹ìˆ˜ ë¬¸ì ì œê±°
2. ì„œë²„ ì¬ì‹œì‘

---

## í…ŒìŠ¤íŠ¸ ê²°ê³¼

### ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

| ê¸°ëŠ¥ | í…ŒìŠ¤íŠ¸ í•­ëª© | ê²°ê³¼ | ë¹„ê³  |
|------|-------------|------|------|
| í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ | ì „ì²´ ëª©ë¡ ë¡œë“œ | âœ… ì„±ê³µ | 5ê°œ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ í™•ì¸ |
| í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„± | ìƒˆ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì¶”ê°€ | âœ… ì„±ê³µ | JSON íŒŒì¼ ì €ì¥ í™•ì¸ |
| í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìˆ˜ì • | ì´ë¦„/ì„¤ëª… ë³€ê²½ | âœ… ì„±ê³µ | ì‹¤ì‹œê°„ ë°˜ì˜ |
| í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì‚­ì œ | í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì œê±° | âœ… ì„±ê³µ | íŒŒì¼ì—ì„œ ì‚­ì œ í™•ì¸ |
| íŠ¸ë™ ê²€ìƒ‰ | YouTube IDë¡œ ê²€ìƒ‰ | âœ… ì„±ê³µ | íŠ¸ë™ ì •ë³´ í‘œì‹œ |
| íŠ¸ë™ ì¶”ê°€ | í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ | âœ… ì„±ê³µ | roundCount ì¦ê°€ |
| íŠ¸ë™ ì œê±° | í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ì—ì„œ ì œê±° | âœ… ì„±ê³µ | roundCount ê°ì†Œ |
| ë°© ìƒì„± | í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì„ íƒ | âœ… ì„±ê³µ | ë“œë¡­ë‹¤ìš´ ì‘ë™ |
| ê²Œì„ ì§„í–‰ | ì»¤ìŠ¤í…€ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ | âœ… ì„±ê³µ | ì •ìƒ ì¬ìƒ |

### API í…ŒìŠ¤íŠ¸

```bash
# í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ëª©ë¡ ì¡°íšŒ
curl http://localhost:3000/api/playlists
# âœ… ì„±ê³µ: 5ê°œ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë°˜í™˜

# í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„±
curl -X POST http://localhost:3000/api/playlists \
  -H "Content-Type: application/json" \
  -d '{"name":"í…ŒìŠ¤íŠ¸","description":"ì„¤ëª…","trackIds":[]}'
# âœ… ì„±ê³µ: 201 Created

# íŠ¸ë™ ì¶”ê°€
curl -X POST http://localhost:3000/api/playlists/custom-abc123/tracks \
  -H "Content-Type: application/json" \
  -d '{"trackId":"dQw4w9WgXcQ"}'
# âœ… ì„±ê³µ: í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸ ë°˜í™˜

# YouTube íŠ¸ë™ ì¡°íšŒ
curl http://localhost:3000/api/youtube/track/dQw4w9WgXcQ
# âœ… ì„±ê³µ: íŠ¸ë™ ì •ë³´ ë°˜í™˜
```

### ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

| í•­ëª© | ì¸¡ì •ê°’ | ëª©í‘œ | ê²°ê³¼ |
|------|--------|------|------|
| í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë¡œë“œ ì‹œê°„ | ~50ms | <100ms | âœ… í†µê³¼ |
| í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì €ì¥ ì‹œê°„ | ~30ms | <100ms | âœ… í†µê³¼ |
| YouTube API ì‘ë‹µ ì‹œê°„ | ~200ms | <500ms | âœ… í†µê³¼ |
| UI ë°˜ì‘ ì†ë„ | ì¦‰ì‹œ | <100ms | âœ… í†µê³¼ |

---

## í–¥í›„ ê°œì„  ì‚¬í•­

### ë‹¨ê¸° ê°œì„  (1-2ì£¼)
1. **ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜**
   - JSON íŒŒì¼ â†’ SQLite/PostgreSQL
   - ë™ì‹œ ì ‘ê·¼ ì²˜ë¦¬
   - íŠ¸ëœì­ì…˜ ì•ˆì „ì„± í–¥ìƒ

2. **íŠ¸ë™ ê²€ìƒ‰ ê°œì„ **
   - YouTube ê²€ìƒ‰ API í†µí•©
   - í‚¤ì›Œë“œë¡œ ê²€ìƒ‰
   - ìë™ì™„ì„± ê¸°ëŠ¥

3. **UI/UX ê°œì„ **
   - ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ íŠ¸ë™ ìˆœì„œ ë³€ê²½
   - ëŒ€ëŸ‰ íŠ¸ë™ ì¶”ê°€ (ì¬ìƒëª©ë¡ URL)
   - í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ë³µì œ ê¸°ëŠ¥

### ì¤‘ê¸° ê°œì„  (1-2ê°œì›”)
1. **í˜‘ì—… ê¸°ëŠ¥**
   - í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê³µìœ 
   - ê³µê°œ/ë¹„ê³µê°œ ì„¤ì •
   - ì‚¬ìš©ìë³„ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬

2. **ë¶„ì„ ê¸°ëŠ¥**
   - í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì¸ê¸°ë„ ì¶”ì 
   - íŠ¸ë™ ì¬ìƒ í†µê³„
   - ì¶”ì²œ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸

3. **ê³ ê¸‰ í•„í„°ë§**
   - ì¥ë¥´ë³„ í•„í„°
   - ì—°ë„ë³„ í•„í„°
   - ì»¤ìŠ¤í…€ íƒœê·¸ ì‹œìŠ¤í…œ

### ì¥ê¸° ê°œì„  (3-6ê°œì›”)
1. **Spotify API í†µí•©**
   - Spotify í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
   - ìë™ YouTube ë§¤ì¹­
   - í¬ë¡œìŠ¤ í”Œë«í¼ ì§€ì›

2. **AI ê¸°ëŠ¥**
   - ìë™ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„±
   - ìœ ì‚¬ ê³¡ ì¶”ì²œ
   - ë‚œì´ë„ ìë™ ì¡°ì ˆ

3. **ëª¨ë°”ì¼ ì•±**
   - React Native ì•±
   - ì˜¤í”„ë¼ì¸ ëª¨ë“œ
   - í‘¸ì‹œ ì•Œë¦¼

---

## ê²°ë¡ 

### êµ¬í˜„ ì„±ê³¼
- âœ… ì™„ì „í•œ CRUD ê¸°ëŠ¥ êµ¬í˜„
- âœ… RESTful API ì„¤ê³„ ë° êµ¬í˜„
- âœ… ì§ê´€ì ì¸ UI/UX ì œê³µ
- âœ… íŒŒì¼ ê¸°ë°˜ ì˜ì†ì„± êµ¬í˜„
- âœ… ê¸°ì¡´ ê²Œì„ ì‹œìŠ¤í…œê³¼ ì™„ë²½í•œ í†µí•©

### ê¸°ìˆ ì  ì„±ê³¼
- TypeScriptë¥¼ í™œìš©í•œ íƒ€ì… ì•ˆì „ì„±
- Svelte 5ì˜ ìƒˆë¡œìš´ Runes API í™œìš©
- Express ë¯¸ë“¤ì›¨ì–´ íŒ¨í„´ ì ìš©
- ì—ëŸ¬ í•¸ë“¤ë§ ë° ì‚¬ìš©ì í”¼ë“œë°± êµ¬í˜„

### í•™ìŠµ í¬ì¸íŠ¸
- íŒŒì¼ ê¸°ë°˜ ë°ì´í„° ì €ì¥ì˜ ì¥ë‹¨ì  ì´í•´
- RESTful API ì„¤ê³„ ì›ì¹™ ì ìš©
- Vite í”„ë¡ì‹œ ì„¤ì • ë° CORS ì´ìŠˆ í•´ê²°
- ë°˜ì‘í˜• UI ìƒíƒœ ê´€ë¦¬

---

## ì°¸ê³  ìë£Œ

### ì½”ë“œ ìœ„ì¹˜
- **Backend**: `packages/server/src/services/playlist.ts`
- **Backend API**: `packages/server/src/index.ts`
- **Frontend**: `packages/client/src/lib/components/PlaylistManager.svelte`
- **Frontend í†µí•©**: `packages/client/src/App.svelte`
- **ë°ì´í„°**: `packages/server/src/data/playlists.json`

### ê´€ë ¨ ë¬¸ì„œ
- [í´ë¼ì´ì–¸íŠ¸-ì„œë²„ ì‹¤ì‹œê°„ í†µì‹  êµ¬í˜„ ë³´ê³ ì„œ](./í´ë¼ì´ì–¸íŠ¸-ì„œë²„%20ì‹¤ì‹œê°„%20í†µì‹ %20êµ¬í˜„%20ë³´ê³ ì„œ.md)
- [ê²Œì„ ì‹œìŠ¤í…œ êµ¬í˜„ ë³´ê³ ì„œ](./ê²Œì„%20ì‹œìŠ¤í…œ%20êµ¬í˜„%20ë³´ê³ ì„œ.md)
- [YouTube API ì—°ë™ êµ¬í˜„ ë³´ê³ ì„œ](./YouTube%20API%20ì—°ë™%20êµ¬í˜„%20ë³´ê³ ì„œ.md)

### ì™¸ë¶€ ì°¸ì¡°
- [Express Documentation](https://expressjs.com/)
- [Svelte 5 Documentation](https://svelte-5-preview.vercel.app/)
- [YouTube Data API](https://developers.google.com/youtube/v3)
- [Vite Proxy Configuration](https://vitejs.dev/config/server-options.html#server-proxy)

---

**ì‘ì„±ì¼**: 2025-11-09
**ì‘ì„±ì**: ListenUp! Team
**ë²„ì „**: 1.0.0
